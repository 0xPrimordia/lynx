const{ethers}=require("hardhat");const fs=require("fs");async function main(){const deploymentInfo=JSON.parse(fs.readFileSync("../deployment-info.json"));const controllerAddr=deploymentInfo.controllerEvm;console.log(`Creating token using controller ${controllerAddr}...`);const IndexTokenController=await ethers.getContractFactory("IndexTokenController");const controller=await IndexTokenController.attach(controllerAddr);console.log("Sending create token transaction...");const tx=await controller.createIndexToken("Lynx Index Token","LYNX","Hedera DeFi Index",{gasLimit:4000000,gasPrice:ethers.parseUnits("600","gwei")});console.log(`Transaction sent: ${tx.hash}`);console.log("Waiting for confirmation (this may take a while)...");await tx.wait();console.log("Transaction confirmed!");try{const tokenAddr=await controller.getTokenAddress();console.log(`Token address: ${tokenAddr}`);deploymentInfo.tokenAddress=tokenAddr;fs.writeFileSync("../deployment-info.json",JSON.stringify(deploymentInfo,null,2));console.log("Deployment info updated");}catch(e){console.error("Error getting token address:",e);}}main().catch(console.error);
